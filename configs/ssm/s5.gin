
from archs.s5 import ssm
from archs import seq_layer
import optimizers


LEARNING_RATE = 5e-4
NUM_WARMUP_STEPS = 20_000


seq_layer.SequenceLayer:
    ssm = @ssm.S5


ssm.S5:
    d_model = %D_MODEL
    ssm_size_base = 256
    num_blocks = 8


optimizers.create_s5_optimizer:
    learning_rate = %LEARNING_RATE
    ssm_learning_rate = %LEARNING_RATE
    opt_config = "standard"


train.Trainer:
    create_optimizer_fn = @optimizers.create_s5_optimizer
